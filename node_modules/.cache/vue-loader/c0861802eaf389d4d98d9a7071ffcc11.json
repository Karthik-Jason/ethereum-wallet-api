{"remainingRequest":"/home/karthik/Desktop/myetherwallet/MyEtherWallet/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/karthik/Desktop/myetherwallet/MyEtherWallet/src/dapps/Ambrpay/containers/SubscriptionForm/SubscriptionForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/karthik/Desktop/myetherwallet/MyEtherWallet/src/dapps/Ambrpay/containers/SubscriptionForm/SubscriptionForm.vue","mtime":1573477611644},{"path":"/home/karthik/Desktop/myetherwallet/MyEtherWallet/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/karthik/Desktop/myetherwallet/MyEtherWallet/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/karthik/Desktop/myetherwallet/MyEtherWallet/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/karthik/Desktop/myetherwallet/MyEtherWallet/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Blockie from '@/components/Blockie';\nimport { mapState } from 'vuex';\nimport { Toast } from '@/helpers';\nimport BigNumber from 'bignumber.js';\n\nexport default {\n  components: {\n    blockie: Blockie\n  },\n  data() {\n    return {\n      address: '',\n      isValidAddress: false,\n      hexAddress: '',\n      intervalDays: '',\n      sendAmount: '',\n      amountErrMsg: '',\n      intervalErrMsg: ''\n    };\n  },\n  computed: {\n    ...mapState(['web3', 'network', 'account']),\n    isValidInput() {\n      return (\n        this.isValidAddress &&\n        !this.amountErrMsg &&\n        this.sendAmount &&\n        this.address &&\n        !this.intervalErrMsg\n      );\n    }\n  },\n  watch: {\n    sendAmount(newVal) {\n      const value = new BigNumber(newVal);\n      const accountBalance = this.web3.utils.fromWei(\n        new BigNumber(this.account.balance).toFixed(),\n        'ether'\n      );\n      const automationFee = new BigNumber(value.times(0.1));\n      const totalVal = value.plus(automationFee);\n\n      if (!newVal) {\n        return (this.amountErrMsg = '');\n      }\n\n      if (value.lt(0.01)) {\n        this.amountErrMsg = 'The minimum amount is 0.01 or greater';\n      } else if (totalVal.gt(accountBalance)) {\n        this.amountErrMsg =\n          'Amount higher than balance (including 1% automation fee)';\n      } else {\n        this.amountErrMsg = '';\n      }\n    },\n    intervalDays(newVal) {\n      if (newVal.startsWith('0') && newVal.length > 1) {\n        this.intervalErrMsg = 'Please enter a correct number';\n      } else if (newVal > 365) {\n        this.intervalErrMsg = 'Number cannot exceed 365 days';\n      } else {\n        this.intervalErrMsg = '';\n      }\n    }\n  },\n  methods: {\n    copyToClipboard() {\n      this.$refs.address.select();\n      document.execCommand('copy');\n      Toast.responseHandler('Copied', Toast.INFO);\n    },\n    sendEntireBalance() {\n      if (this.account) {\n        this.sendAmount = this.web3.utils.fromWei(\n          new BigNumber(this.account.balance).toFixed(),\n          'ether'\n        );\n      }\n    },\n    startSubscription() {\n      const data = {\n        subscriptionPlan: 'sp_f06PoxHvvutJZd',\n        amount: new BigNumber(this.sendAmount).toNumber(),\n        receiverWallet: this.address,\n        interval: new BigNumber(this.intervalDays).toNumber(),\n        transferOut: true,\n        network: 'auto'\n      };\n\n      this.$emit('startSubscription', data);\n\n      this.$nextTick(() => {\n        this.sendAmount = '';\n        this.address = '';\n        this.intervalDays = '';\n      });\n    }\n  }\n};\n",{"version":3,"sources":["SubscriptionForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8GA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SubscriptionForm.vue","sourceRoot":"src/dapps/Ambrpay/containers/SubscriptionForm","sourcesContent":["<template>\n  <div class=\"subscription-container\">\n    <div class=\"subscription-content\">\n      <div class=\"subscription-form-container\">\n        <b-container>\n          <b-row>\n            <span class=\"label-text\">{{ $t('dappsAmbrpay.to-address') }}</span>\n            <p\n              class=\"action-text prevent-user-select copy-text\"\n              @click=\"copyToClipboard\"\n            >\n              {{ $t('common.copy') }}\n            </p>\n          </b-row>\n          <b-row class=\"address-block\">\n            <span class=\"row-style\">\n              <blockie\n                v-show=\"isValidAddress\"\n                :address=\"hexAddress\"\n                :size=\"6\"\n                :scale=\"16\"\n                width=\"32px\"\n                height=\"32px\"\n                class=\"blockie-image\"\n              />\n              <input\n                v-ens-resolver=\"'address'\"\n                ref=\"address\"\n                v-model=\"address\"\n                :class=\"isValidAddress ? 'input-address' : ''\"\n                name=\"name\"\n                autocomplete=\"off\"\n                type=\"text\"\n              />\n              <i\n                :class=\"[\n                  isValidAddress && hexAddress.length !== 0 ? '' : 'not-good',\n                  'fa fa-check-circle good-button'\n                ]\"\n                aria-hidden=\"true\"\n              />\n            </span>\n          </b-row>\n          <b-row>\n            <b-col class=\"mt-3\" cols=\"12\" md=\"5\">\n              <span class=\"label-text\">{{ $t('dappsAmbrpay.type') }}</span>\n              <div class=\"fake-input\">\n                <p>\n                  <img\n                    class=\"currency-icon\"\n                    src=\"@/assets/images/currency/eth.svg\"\n                  />\n                  <span class=\"token-txt\">{{ $t('dappsAmbrpay.eth') }}</span\n                  >-{{ $t('dappsAmbrpay.ethereum') }}\n                </p>\n              </div>\n            </b-col>\n            <b-col class=\"amount-container mt-3\" cols=\"12\" md=\"7\">\n              <div class=\"amount-text\">\n                <span class=\"label-text\">{{ $t('dappsAmbrpay.amount') }}</span>\n                <span\n                  class=\"action-text entire-balance\"\n                  @click=\"sendEntireBalance\"\n                  >{{ $t('dappsAmbrpay.entire-balance') }}</span\n                >\n              </div>\n              <input\n                v-model=\"sendAmount\"\n                type=\"number\"\n                placeholder=\"0.01\"\n                min=\"0.01\"\n              />\n              <p class=\"sub-text\">{{ $t('dappsAmbrpay.automation-fee') }}</p>\n              <p v-show=\"amountErrMsg\" class=\"sub-text err-msg\">\n                {{ amountErrMsg }}\n              </p>\n            </b-col>\n          </b-row>\n          <b-row class=\"row-style mt-1 interval-container\">\n            <span class=\"label-text\">{{\n              $t('dappsAmbrpay.interval-in-every')\n            }}</span>\n            <span v-show=\"intervalDays\" class=\"days-text\">{{\n              $t('dappsAmbrpay.days')\n            }}</span>\n            <input\n              v-model=\"intervalDays\"\n              :placeholder=\"$t('dappsAmbrpay.enter-days')\"\n              type=\"number\"\n              min=\"1\"\n              max=\"365\"\n            />\n            <p v-show=\"intervalErrMsg\" class=\"sub-text err-msg\">\n              {{ intervalErrMsg }}\n            </p>\n          </b-row>\n          <b-row class=\"mt-4\">\n            <b-button\n              :class=\"[isValidInput ? '' : 'disabled', 'mx-auto mew-btn']\"\n              @click=\"startSubscription\"\n              >{{ $t('dappsAmbrpay.start-recurring') }}</b-button\n            >\n          </b-row>\n        </b-container>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Blockie from '@/components/Blockie';\nimport { mapState } from 'vuex';\nimport { Toast } from '@/helpers';\nimport BigNumber from 'bignumber.js';\n\nexport default {\n  components: {\n    blockie: Blockie\n  },\n  data() {\n    return {\n      address: '',\n      isValidAddress: false,\n      hexAddress: '',\n      intervalDays: '',\n      sendAmount: '',\n      amountErrMsg: '',\n      intervalErrMsg: ''\n    };\n  },\n  computed: {\n    ...mapState(['web3', 'network', 'account']),\n    isValidInput() {\n      return (\n        this.isValidAddress &&\n        !this.amountErrMsg &&\n        this.sendAmount &&\n        this.address &&\n        !this.intervalErrMsg\n      );\n    }\n  },\n  watch: {\n    sendAmount(newVal) {\n      const value = new BigNumber(newVal);\n      const accountBalance = this.web3.utils.fromWei(\n        new BigNumber(this.account.balance).toFixed(),\n        'ether'\n      );\n      const automationFee = new BigNumber(value.times(0.1));\n      const totalVal = value.plus(automationFee);\n\n      if (!newVal) {\n        return (this.amountErrMsg = '');\n      }\n\n      if (value.lt(0.01)) {\n        this.amountErrMsg = 'The minimum amount is 0.01 or greater';\n      } else if (totalVal.gt(accountBalance)) {\n        this.amountErrMsg =\n          'Amount higher than balance (including 1% automation fee)';\n      } else {\n        this.amountErrMsg = '';\n      }\n    },\n    intervalDays(newVal) {\n      if (newVal.startsWith('0') && newVal.length > 1) {\n        this.intervalErrMsg = 'Please enter a correct number';\n      } else if (newVal > 365) {\n        this.intervalErrMsg = 'Number cannot exceed 365 days';\n      } else {\n        this.intervalErrMsg = '';\n      }\n    }\n  },\n  methods: {\n    copyToClipboard() {\n      this.$refs.address.select();\n      document.execCommand('copy');\n      Toast.responseHandler('Copied', Toast.INFO);\n    },\n    sendEntireBalance() {\n      if (this.account) {\n        this.sendAmount = this.web3.utils.fromWei(\n          new BigNumber(this.account.balance).toFixed(),\n          'ether'\n        );\n      }\n    },\n    startSubscription() {\n      const data = {\n        subscriptionPlan: 'sp_f06PoxHvvutJZd',\n        amount: new BigNumber(this.sendAmount).toNumber(),\n        receiverWallet: this.address,\n        interval: new BigNumber(this.intervalDays).toNumber(),\n        transferOut: true,\n        network: 'auto'\n      };\n\n      this.$emit('startSubscription', data);\n\n      this.$nextTick(() => {\n        this.sendAmount = '';\n        this.address = '';\n        this.intervalDays = '';\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '../../AmbrpayGlobal.scss';\n@import 'SubscriptionForm.scss';\n</style>\n"]}]}